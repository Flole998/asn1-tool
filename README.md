# ASN.1 Tool

[![Build Status](https://travis-ci.org/yafred/asn1-tool.svg?branch=master)](https://travis-ci.org/yafred/asn1-tool)
[![Coverage Status](https://coveralls.io/repos/github/yafred/asn1-tool/badge.svg?branch=master)](https://coveralls.io/github/yafred/asn1-tool?branch=master)

## Using the compiler
  
The compiler generates Java classes and encoding/decoding method from an ASN.1 specification.  
  
  * Download [latest release](https://github.com/yafred/asn1-tool/releases) 
  * java -jar asn1-compiler.jar
     * -f \<input file> ASN.1 specification.
     * -p just print the validated model.
     * -jo \<path> generate Java code in the given folder.
     * -jp \<package> use this package as a prefix for generated Java code (ASN.1 module names are added to this prefix to get the full package name).
  * You can create an alias with alias on Linux or doskey on Windows 
  
## Using the converter
  
The converter helps testing the classes generated by the compiler. It lets the generated class decode an ASN.1 stream from an input file and encode an ASN.1 stream to an output file.
  
  * Download [latest release](https://github.com/yafred/asn1-tool/releases) 
  * java -cp \<path to the generated classes>;asn1-converter.jar com.yafred.asn1.tool.Converter
     * -i \<input file> ASN.1 encoded data (BER or ASN value notation) written by you.
     * -dec type of encoded data in input file (BER or ASN)
     * -o \<output file> ASN.1 encoded data (BER) written by the converter
     * -enc type of encoded data in output file (BER)
     * -c name of the generated class under test (compiled class must be in the converter classpath) 

## Warning

This tool is in development
  
## Example

### Write your ASN.1 specification

```
G-009 DEFINITIONS AUTOMATIC TAGS ::= 
BEGIN 

Flight ::= SEQUENCE {
   origin             IA5String,
   destination        IA5String,
   seats  INTEGER,
   crew-format ENUMERATED { six, eight, ten }
}

END
```

### Validate it

```
java -jar asn1-compiler.jar -f your_spec.asn -p

G-009 DEFINITIONS AUTOMATIC TAGS ::=
BEGIN

   EXPORTS ALL;
   IMPORTS;

   Flight ::= SEQUENCE {
      origin [0] IMPLICIT IA5String,
      destination [1] IMPLICIT IA5String,
      seats [2] IMPLICIT INTEGER,
      crew-format [3] IMPLICIT ENUMERATED { six(0), eight(1), ten(2) }
   }

END
```

### Generate the java code 

```
java -jar asn1-compiler.jar -f your_spec.asn -jo your_ouput_folder
```

### Integrate the java bindings in your code

```
Flight obj = new Flight();
obj.setOrigin("Rome");
obj.setDestination("London");
obj.setSeats(Integer.valueOf(250));
obj.setCrewFormat(Flight.CrewFormat.EIGHT);
```

### Use the BER encoders/decoders to serialize/deserialize your objects (binary)

```
// encode a Flight
ByteArrayOutputStream bufferOut = new ByteArrayOutputStream();
BERWriter berWriter = new BERWriter(bufferOut);
Flight.writePdu(obj, berWriter);

byte[] berEncoded = bufferOut.toByteArray(); 

// decode a Flight
ByteArrayInputStream input = new ByteArrayInputStream(berEncoded);
BERReader berReader = new BERReader(input);
Flight obj = Flight.readPdu(berReader);
```

### Use the ASN decoders to deserialize your objects (text)

```
// encode a Flight (Not implemented yet)

// decode a Flight
String asnValue = "{" + 
		"  origin \"Rome\"," + 
		"  destination \"London\"," + 
		"  seats 250," + 
		"  crew-format eight" + 
		"}";

InputStream inputStream = new ByteArrayInputStream(asnValue.getBytes(StandardCharsets.UTF_8));
ASNValueReader asnValueReader = new ASNValueReader(inputStream);
Flight obj = Flight.readPdu(asnValueReader);
```

